---
title: "Reproducible Research Project 1"
output: github_document
---

## Introducing the Project
In this project, we will be analyzing an anonymous individual's walking routine over the following time interval: **October 1st 2012 - November 30th 2012**. Specifically, we will assess the number of steps taken over five minute interval measurements. 

##Task 1: Reading the CSV file

The "activity.csv" file that was provided by Coursera is already relatively easy to work with. I created the following function to read the file into my workspace:

```{r}
#set appropriate working directory (location depends on individual)
setwd("~/R Material/Coursera/Course 5 Reproducible Research/Week 1/repdata_data_activity")
#Activate dplyr
library(dplyr)

#Read in csv file, cleaning up column names and coercing 2nd column into a Date class
ReadFile <- function(){
      return(read.csv("activity.csv", colClasses = c("integer","Date", "integer"),
                      col.names = c("Steps", "Date", "Interval")))
}

ActivityFile <- ReadFile()
head(ActivityFile)
```

Before moving onto the assignment questions, we will look at a summary of the data table
```{r}
summary(ActivityFile)
```

There are 2304 NA values for the Steps column, so we will keep this in mind when we move forward with the analysis. 

##Task 2: Create histogram for the total number of steps per day

For this calculation, we will ignore rows containing NA values. Using the cleaned ActivityFile data table as an *arguement*, I created two functions to first calcuate the total steps per day, and then create a histogram representation. 
```{r}
#Function takes our ActivityFile data table as an arguement to calculate total steps/day
StepSumPerDay <- function(ActivityFrame){
      #filter out rows with NA values, group by Day, and then calculate sum per day
      ActivityFrame <- filter(ActivityFrame, is.na(Steps) == FALSE) %>% group_by(Date) %>%
            summarise(sum(Steps))
      #Clean up variable names
      names(ActivityFrame) <- c("Date", "StepTotal")
      ActivityFrame
}
```

When I call this function we will get the appropriate table of **total steps per day**

```{r}
TotalStep <- StepSumPerDay(ActivityFile)
head(TotalStep)
```

I then created a function that takes the "Steps" column variable (from TotalStep) and plotted a histogram spread, utilizing the ggplot2 package

```{r}
library(ggplot2)
StepTotalHist <- function(StepTotalFrame, Title){
      g <- ggplot(data = StepTotalFrame, aes(StepTotal)) +
            geom_histogram(binwidth = 1000, color = "black", fill = "pink") + ggtitle(Title) + ylim(0,10)
      return(g)
}

HistogramStepTotal <- StepTotalHist(TotalStep, "Total Steps Per Day")
print(HistogramStepTotal)
```

##Task 3: Determine the mean and median values for steps/day

For this task, I created two simple functions.

```{r}
CalculateMean <- function(StepVector){
      MeanSteps <- mean(StepVector)
}
MeanSteps <- paste("Mean Steps/Day:",  CalculateMean(TotalStep$StepTotal))
print(MeanSteps)

CalculateMedian <- function(StepVector){
      MedianSteps <- median(StepVector)
}

StepMedian <- paste("Median Steps/Day:" ,  CalculateMedian(TotalStep$StepTotal))
print(StepMedian)
```

##Task 4: Create a time-series plot of the average number of steps taken, across all days

We will go back to using our original ActivityFile data table for this task. I created a function to perform tasks that are similar to what was done for task 2. The difference is that we need to group by interval and take an average value.

```{r}
AvgStepsPerInterval <- function(ActivityFrame){
      ActivityFrame <- filter(ActivityFrame, is.na(Steps) == FALSE) %>%
            group_by(Interval) %>%summarise(mean(Steps))
      
      names(ActivityFrame) <- c("Interval", "StepMean")
      ActivityFrame
}

MeanStepPerInterval <- AvgStepsPerInterval(ActivityFile)
head(MeanStepPerInterval)
```

Using the time interval as th x-variable and the mean steps as the y-variable, we will create a time-series plot (type = "l").

```{r}
with(MeanStepPerInterval, plot(Interval, StepMean, type = "l"))
```

#Task 5: Find the time interval with the higest average step value

```{r}
print(MeanStepPerInterval[which.max(MeanStepPerInterval$StepMean),])
```

Therefore, we can conclude that in the interval of 800-835 minutes, the highest avg steps are taken. This agrees with our previous time-series plot.

##Task 6: Impute missing values

We already discussed the number of NA values (refer to Task 1). It can easily be found by using the summary() function. There were 2304 NA values. Now, our goal is to impute values for the missing data. For the sake of simplicity, any NA value will take the mean Step value for that given interval. First, I merged the Activity File with the MeanStepPerInterval into one big table.

```{r}
MergeFrame <- merge(ActivityFile, MeanStepPerInterval, by = "Interval")
head(MergeFrame)
```

Next we call a function that locates NA values and replaces them with the appropriate mean step value.

```{r}
ImputeMissingValues <- function(StepVector, MeanStepVector){
      for (i in c(1:length(StepVector))){
            if (is.na(StepVector[i])== TRUE){
                  StepVector[i] <- MeanStepVector[i]
            }
      }
      StepVector

}
#Replace the Steps column with the appropriate imputed values
MergeFrame$Steps <- ImputeMissingValues(MergeFrame$Steps, MergeFrame$StepMean)
#Check whether it worked
print(sum(is.na(MergeFrame$Steps)))
```

We will now call upon functions we previously created to create a histogram.

```{r}
ImputedTotalSteps <- StepSumPerDay(select(MergeFrame, c(Steps,Date, Interval)))
head(ImputedTotalSteps)

ImputedHistogramStepTotal <- StepTotalHist(ImputedTotalSteps, "Total Steps Per Day (Imputed)")

#Import GridExtra which is good for comparison plotting
library(gridExtra)

grid.arrange(HistogramStepTotal,ImputedHistogramStepTotal, ncol =2)

print(paste("Imputed Mean Steps/Day:", CalculateMean(ImputedTotalSteps$StepTotal), "     ",MeanSteps))

print(paste("Imputed Median Steps/Day:", CalculateMean(ImputedTotalSteps$StepTotal), "     ", StepMedian))
```

Clearly, there are some difference when values are imputed. 